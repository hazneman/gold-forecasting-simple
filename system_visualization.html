<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gold Price Forecasting - System Architecture</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
            line-height: 1.6;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        h1 {
            color: #DAA520;
            text-align: center;
            border-bottom: 3px solid #DAA520;
            padding-bottom: 15px;
            margin-bottom: 30px;
        }
        h2 {
            color: #2C3E50;
            border-left: 5px solid #DAA520;
            padding-left: 15px;
            margin-top: 40px;
        }
        .diagram-container {
            background: #fafafa;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            overflow-x: auto;
        }
        .mermaid {
            text-align: center;
        }
        .description {
            background: #e8f4fd;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .feature-card {
            background: #f0f8ff;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
        }
        .feature-card h3 {
            color: #DAA520;
            margin-top: 0;
        }
        .stats {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            margin: 20px 0;
        }
        .stat {
            text-align: center;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
            margin: 5px;
            min-width: 120px;
        }
        .stat-number {
            font-size: 2em;
            font-weight: bold;
        }
        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }
        .nav-tabs {
            display: flex;
            background: #f1f1f1;
            border-radius: 8px;
            padding: 5px;
            margin-bottom: 20px;
        }
        .nav-tab {
            flex: 1;
            text-align: center;
            padding: 10px;
            background: transparent;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            transition: background 0.3s;
        }
        .nav-tab.active {
            background: #DAA520;
            color: white;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🥇 Gold Price Forecasting System Architecture</h1>
        
        <div class="description">
            <strong>System Overview:</strong> A comprehensive machine learning pipeline for gold price forecasting using multiple data sources, 
            advanced feature engineering, ensemble modeling, and real-time API services.
        </div>

        <div class="stats">
            <div class="stat">
                <div class="stat-number">15+</div>
                <div class="stat-label">Data Sources</div>
            </div>
            <div class="stat">
                <div class="stat-number">50+</div>
                <div class="stat-label">Features</div>
            </div>
            <div class="stat">
                <div class="stat-number">8</div>
                <div class="stat-label">ML Models</div>
            </div>
            <div class="stat">
                <div class="stat-number">7</div>
                <div class="stat-label">API Endpoints</div>
            </div>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('system')">System Workflow</button>
            <button class="nav-tab" onclick="showTab('model')">Model Architecture</button>
            <button class="nav-tab" onclick="showTab('api')">API Flow</button>
            <button class="nav-tab" onclick="showTab('sequence')">Data Flow</button>
        </div>

        <div id="system" class="tab-content active">
            <h2>📊 Complete System Workflow</h2>
            <div class="description">
                This diagram shows the end-to-end data flow from multiple sources through feature engineering, 
                model training, prediction, and user interfaces.
            </div>
            <div class="diagram-container">
                <div class="mermaid">
                graph TB
                    %% Data Sources
                    subgraph "Data Sources"
                        YF[Yahoo Finance<br/>GLD ETF]
                        AV[Alpha Vantage<br/>API]
                        FRED[Federal Reserve<br/>Economic Data]
                        MA[Metals API]
                    end

                    %% Data Collection Layer
                    subgraph "Data Collection Layer"
                        DC[GoldDataCollector<br/>Class]
                        YF --> DC
                        AV --> DC
                        FRED --> DC
                        MA --> DC
                    end

                    %% Raw Data Storage
                    subgraph "Data Storage"
                        RD[(Raw Data<br/>data/raw/)]
                        PD[(Processed Data<br/>data/processed/)]
                        MD[(Models<br/>data/models/)]
                    end

                    DC --> RD

                    %% Feature Engineering
                    subgraph "Feature Engineering"
                        FE[FeatureEngineer<br/>Class]
                        subgraph "Technical Indicators"
                            RSI[RSI]
                            MACD[MACD]
                            BB[Bollinger Bands]
                            SMA[Moving Averages]
                        end
                    end

                    RD --> FE
                    FE --> RSI
                    FE --> MACD
                    FE --> BB
                    FE --> SMA
                    RSI --> PD
                    MACD --> PD
                    BB --> PD
                    SMA --> PD

                    %% Machine Learning Models
                    subgraph "ML Models"
                        subgraph "Linear Models"
                            LR[Linear Regression]
                            RIDGE[Ridge Regression]
                        end
                        subgraph "Tree Models"
                            RF[Random Forest]
                            XGB[XGBoost]
                        end
                        subgraph "Neural Networks"
                            LSTM[LSTM Networks]
                        end
                        subgraph "Ensemble"
                            VOTING[Ensemble Model]
                        end
                    end

                    PD --> LR
                    PD --> RIDGE
                    PD --> RF
                    PD --> XGB
                    PD --> LSTM

                    LR --> VOTING
                    RF --> VOTING
                    LSTM --> VOTING
                    XGB --> VOTING

                    %% Prediction & Analysis
                    subgraph "Output"
                        PRED[Price Prediction]
                        CONF[Confidence Intervals]
                        TREND[Trend Analysis]
                    end

                    VOTING --> PRED
                    PRED --> CONF
                    PRED --> TREND

                    %% API Layer
                    subgraph "API Layer"
                        FASTAPI[FastAPI Server]
                        ENDPOINTS[REST Endpoints]
                    end

                    PRED --> FASTAPI
                    CONF --> FASTAPI
                    TREND --> FASTAPI
                    FASTAPI --> ENDPOINTS

                    %% User Interfaces
                    subgraph "User Interfaces"
                        WEB[Web Interface]
                        CLI[Command Line]
                        DOCS[API Documentation]
                    end

                    ENDPOINTS --> WEB
                    ENDPOINTS --> CLI
                    ENDPOINTS --> DOCS

                    classDef dataSource fill:#e1f5fe
                    classDef processing fill:#f3e5f5
                    classDef model fill:#e8f5e8
                    classDef output fill:#fff3e0
                    classDef interface fill:#fce4ec

                    class YF,AV,FRED,MA dataSource
                    class DC,FE processing
                    class LR,RF,LSTM,VOTING,XGB model
                    class PRED,CONF,TREND output
                    class WEB,CLI,DOCS interface
                </div>
            </div>
        </div>

        <div id="model" class="tab-content">
            <h2>🧠 Model Architecture</h2>
            <div class="description">
                Detailed view of the machine learning pipeline showing feature processing and ensemble modeling approach.
            </div>
            <div class="diagram-container">
                <div class="mermaid">
                graph LR
                    subgraph "Input Features"
                        PRICE[Price History<br/>OHLCV Data]
                        TECH[Technical Indicators<br/>RSI, MACD, Bollinger]
                        TIME[Time Features<br/>Day, Month, Quarter]
                    end

                    subgraph "Feature Processing"
                        NORM[Normalization<br/>StandardScaler]
                        LAG[Lag Features<br/>1, 7, 30 days]
                        ROLLING[Rolling Statistics<br/>Mean, Std, Min, Max]
                    end

                    subgraph "Model Ensemble"
                        M1[Linear Regression<br/>Weight: 0.25]
                        M2[Random Forest<br/>Weight: 0.30]
                        M3[XGBoost<br/>Weight: 0.30]
                        M4[LSTM<br/>Weight: 0.15]
                        
                        META[Meta-Learner<br/>Weighted Average]
                    end

                    subgraph "Output"
                        PRED_PRICE[Predicted Price]
                        CONF_INT[Confidence Interval]
                        DIRECTION[Price Direction]
                    end

                    PRICE --> NORM
                    TECH --> NORM
                    TIME --> NORM

                    NORM --> LAG
                    LAG --> ROLLING

                    ROLLING --> M1
                    ROLLING --> M2
                    ROLLING --> M3
                    ROLLING --> M4

                    M1 --> META
                    M2 --> META
                    M3 --> META
                    M4 --> META

                    META --> PRED_PRICE
                    META --> CONF_INT
                    META --> DIRECTION

                    classDef input fill:#e3f2fd
                    classDef process fill:#f1f8e9
                    classDef model fill:#fff8e1
                    classDef output fill:#fce4ec

                    class PRICE,TECH,TIME input
                    class NORM,LAG,ROLLING process
                    class M1,M2,M3,M4,META model
                    class PRED_PRICE,CONF_INT,DIRECTION output
                </div>
            </div>
        </div>

        <div id="api" class="tab-content">
            <h2>🌐 API Endpoint Architecture</h2>
            <div class="description">
                FastAPI server architecture showing request routing, endpoints, and data services.
            </div>
            <div class="diagram-container">
                <div class="mermaid">
                graph TD
                    subgraph "Clients"
                        WEB_CLIENT[Web Browser]
                        API_CLIENT[Python Client]
                        CURL[cURL/CLI]
                    end

                    subgraph "FastAPI Server"
                        ROUTER[Request Router]
                        MIDDLEWARE[CORS Middleware]
                    end

                    subgraph "API Endpoints"
                        HEALTH["/health<br/>System Status"]
                        CURRENT["/current-price<br/>Latest Gold Price"]
                        FORECAST["/simple-forecast<br/>Price Predictions"]
                        DOCS["/docs<br/>API Documentation"]
                    end

                    subgraph "Services"
                        DATA_SERVICE[Data Collection Service]
                        MODEL_SERVICE[ML Model Service]
                        CACHE_SERVICE[Cache Service]
                    end

                    subgraph "Data Sources"
                        YAHOO[Yahoo Finance API]
                        FILES[Local Data Files]
                        MODELS[Trained Models]
                    end

                    WEB_CLIENT --> ROUTER
                    API_CLIENT --> ROUTER
                    CURL --> ROUTER

                    ROUTER --> MIDDLEWARE
                    MIDDLEWARE --> HEALTH
                    MIDDLEWARE --> CURRENT
                    MIDDLEWARE --> FORECAST
                    MIDDLEWARE --> DOCS

                    CURRENT --> DATA_SERVICE
                    FORECAST --> MODEL_SERVICE
                    
                    DATA_SERVICE --> YAHOO
                    DATA_SERVICE --> FILES
                    MODEL_SERVICE --> MODELS
                    MODEL_SERVICE --> CACHE_SERVICE

                    classDef client fill:#e8eaf6
                    classDef server fill:#e0f2f1
                    classDef endpoint fill:#fff3e0
                    classDef service fill:#f3e5f5
                    classDef storage fill:#fce4ec

                    class WEB_CLIENT,API_CLIENT,CURL client
                    class ROUTER,MIDDLEWARE server
                    class HEALTH,CURRENT,FORECAST,DOCS endpoint
                    class DATA_SERVICE,MODEL_SERVICE,CACHE_SERVICE service
                    class YAHOO,FILES,MODELS storage
                </div>
            </div>
        </div>

        <div id="sequence" class="tab-content">
            <h2>⏱️ Real-time Data Flow Sequence</h2>
            <div class="description">
                Sequence diagram showing the step-by-step process when a client requests a gold price forecast.
            </div>
            <div class="diagram-container">
                <div class="mermaid">
                sequenceDiagram
                    participant Client
                    participant API
                    participant DataCollector
                    participant YahooFinance
                    participant FeatureEngineer
                    participant Model

                    Client->>API: GET /simple-forecast?days=7
                    Note over API: Validate request parameters
                    
                    API->>DataCollector: get_latest_data()
                    DataCollector->>YahooFinance: fetch GLD ETF data
                    YahooFinance-->>DataCollector: OHLCV price data
                    DataCollector-->>API: cleaned price data
                    
                    API->>FeatureEngineer: create_features(data)
                    Note over FeatureEngineer: Calculate technical indicators
                    FeatureEngineer->>FeatureEngineer: RSI, MACD, Moving Averages
                    FeatureEngineer->>FeatureEngineer: Time-based features
                    FeatureEngineer-->>API: feature matrix
                    
                    API->>Model: generate_forecast(features, days=7)
                    Note over Model: Ensemble prediction
                    Model->>Model: Linear + Tree + LSTM models
                    Model->>Model: Weighted average
                    Model-->>API: predictions array
                    
                    Note over API: Calculate confidence & trends
                    API-->>Client: JSON forecast response
                </div>
            </div>
        </div>

        <div class="feature-grid">
            <div class="feature-card">
                <h3>🔍 Data Sources</h3>
                <ul>
                    <li>Yahoo Finance (GLD ETF)</li>
                    <li>Federal Reserve Economic Data</li>
                    <li>Alpha Vantage API</li>
                    <li>Metals-API.com</li>
                </ul>
            </div>
            
            <div class="feature-card">
                <h3>📈 Technical Indicators</h3>
                <ul>
                    <li>RSI (Relative Strength Index)</li>
                    <li>MACD (Moving Average Convergence)</li>
                    <li>Bollinger Bands</li>
                    <li>Moving Averages (5, 20, 50, 200)</li>
                </ul>
            </div>
            
            <div class="feature-card">
                <h3>🤖 ML Models</h3>
                <ul>
                    <li>Linear Regression</li>
                    <li>Random Forest</li>
                    <li>XGBoost</li>
                    <li>LSTM Neural Networks</li>
                </ul>
            </div>
            
            <div class="feature-card">
                <h3>🌐 API Endpoints</h3>
                <ul>
                    <li>GET /health - System status</li>
                    <li>GET /current-price - Latest price</li>
                    <li>GET /simple-forecast - Predictions</li>
                    <li>GET /docs - Documentation</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                htmlLabels: true,
                curve: 'basis'
            }
        });

        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }
    </script>
</body>
</html>